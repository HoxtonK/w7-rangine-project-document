(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-38a13e94"],{4917:function(e,t,a){"use strict";var i=a("cb7c"),o=a("9def"),s=a("0390"),r=a("5f1b");a("214f")("match",1,(function(e,t,a,n){return[function(a){var i=e(this),o=void 0==a?void 0:a[t];return void 0!==o?o.call(a,i):new RegExp(a)[t](String(i))},function(e){var t=n(a,e,this);if(t.done)return t.value;var l=i(e),c=String(this);if(!l.global)return r(l,c);var _=l.unicode;l.lastIndex=0;var u,d=[],p=0;while(null!==(u=r(l,c))){var g=String(u[0]);d[p]=g,""===g&&(l.lastIndex=s(c,o(l.lastIndex),_)),p++}return 0===p?null:d}]}))},"7b79":function(e,t,a){"use strict";var i=a("903e"),o=a.n(i);o.a},"903e":function(e,t,a){},b56e:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"container"},[a("div",{staticClass:"page-head"},[e._v("我的文档管理")]),a("div",{staticClass:"container-box"},[a("div",{staticClass:"search-box"},[a("div",{staticClass:"search-box-input"},[a("el-input",{staticClass:"demo-input-suffix",attrs:{placeholder:"请输入文档名称",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getAllProject(t)}},model:{value:e.listQuery.keyword,callback:function(t){e.$set(e.listQuery,"keyword",t)},expression:"listQuery.keyword"}},[a("i",{staticClass:"el-input__icon el-icon-search",attrs:{slot:"suffix"},on:{click:e.getAllProject},slot:"suffix"})]),a("el-select",{on:{change:e.getAllProject},model:{value:e.listQuery.is_public,callback:function(t){e.$set(e.listQuery,"is_public",t)},expression:"listQuery.is_public"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"公有",value:"1"}}),a("el-option",{attrs:{label:"私有",value:"2"}})],1),a("el-select",{on:{change:e.getAllProject},model:{value:e.listQuery.role,callback:function(t){e.$set(e.listQuery,"role",t)},expression:"listQuery.role"}},[a("el-option",{attrs:{label:"全部",value:""}}),a("el-option",{attrs:{label:"我创建的",value:"1"}}),a("el-option",{attrs:{label:"我操作的",value:"2"}})],1)],1)]),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"card-box"},[a("div",{staticClass:"card-warpper"},[e._l(e.docList,(function(t,i){return a("div",{key:i,staticClass:"w7-card",class:{"has-cover":t.cover},style:{backgroundImage:"url("+t.cover+")"},on:{click:function(a){return e.goChapter(t)}}},[t.cover?a("div",{staticClass:"mask"}):e._e(),a("div",{staticClass:"mask-content"},[a("div",{staticClass:"w7-card-title"},[e._v("\n              "+e._s(t.name)+"\n            ")]),a("div",{staticClass:"time-wrap"},[t.is_public?e._e():a("i",{staticClass:"wi wi-lock"}),a("div",{staticClass:"w7-card-time"},[e._v(e._s(e.format(t.operator.time))+" "+e._s(t.operator.name))])]),a("div",{staticClass:"icon-box"},[t.acl.has_manage?a("el-tooltip",{attrs:{effect:"dark",content:"转让项目",placement:"bottom"}},[a("i",{staticClass:"wi wi-transfer",on:{click:function(a){return a.stopPropagation(),e.transferDoc(t.id)}}})]):e._e(),a("el-tooltip",{attrs:{effect:"dark",content:"预览",placement:"bottom"}},[a("i",{staticClass:"wq wq-chakan",on:{click:function(a){return a.stopPropagation(),e.readDoc(t)}}})]),t.acl.has_manage?a("el-tooltip",{attrs:{effect:"dark",content:"进入管理",placement:"bottom"}},[a("i",{staticClass:"wi wi-guanli",on:{click:function(a){return a.stopPropagation(),e.settingDoc(t.id)}}})]):e._e()],1),a("div",{staticClass:"line"})])])})),a("div",{staticClass:"w7-card add-project",on:{click:e.dialogDocShow}},[a("div",{staticClass:"add-text"},[e._v("新建项目")]),a("i",{staticClass:"el-icon-circle-plus"}),a("div",{staticClass:"line"})])],2)]),a("div",{staticClass:"pagination-wrap"},[a("el-pagination",{attrs:{background:"","hide-on-single-page":e.total<=11,"current-page":e.listQuery.page,"page-sizes":[11,23,35],"page-size":e.listQuery.page_size,layout:e.paginationLayouts,total:e.total},on:{"update:currentPage":function(t){return e.$set(e.listQuery,"page",t)},"update:current-page":function(t){return e.$set(e.listQuery,"page",t)},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{staticClass:"w7-dialog",attrs:{title:"创建项目",visible:e.dialogDocInfoVisible,"close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.dialogDocInfoVisible=t}}},[a("el-form",{attrs:{"label-width":"105px","label-position":"left"}},[a("el-form-item",{attrs:{label:"项目名称"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.name,callback:function(t){e.name=t},expression:"name"}})],1),a("el-radio-group",{staticClass:"ownership",model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[a("el-radio",{attrs:{label:"1"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("公开项目")]),a("el-radio",{attrs:{label:"2"},model:{value:e.radio,callback:function(t){e.radio=t},expression:"radio"}},[e._v("私有项目")])],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.createDoc}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.dialogDocInfoVisible=!1}}},[e._v("取 消")])],1)],1),a("el-dialog",{staticClass:"w7-dialog",attrs:{title:"管理员转让",visible:e.dialogTransferDoc,"close-on-click-modal":!1,center:""},on:{"update:visible":function(t){e.dialogTransferDoc=t}}},[a("div",{staticClass:"transfer-tip"},[a("i",{staticClass:"el-icon-warning"}),e._v("转让管理员权限后您将成为操作员，不再是管理员，请谨慎操作。\n      ")]),a("el-form",{attrs:{"label-width":"115px","label-position":"left"}},[a("el-form-item",{attrs:{label:"选择新的管理员"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.transferUsername,callback:function(t){e.transferUsername=t},expression:"transferUsername"}})],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.transfer}},[e._v("确 定")]),a("el-button",{on:{click:function(t){e.dialogTransferDoc=!1}}},[e._v("取 消")])],1)],1)],1),a("el-dialog",{staticClass:"we7-dialog dialog-setting",attrs:{title:"项目设置",width:"1000px",visible:e.showSetting,"close-on-click-modal":!1,"before-close":e.handleClose},on:{"update:visible":function(t){e.showSetting=t}}},[a("setting",{attrs:{id:e.settingDocId}})],1)],1)},o=[],s=(a("ac6a"),a("7f7f"),a("fa7d")),r=a("4ec3"),n=a("49f7"),l={name:"documentIndex",components:{setting:n["a"]},data:function(){return{listQuery:{page:1,page_size:11,keyword:"",role:"",is_public:""},radio:"1",loading:!1,docList:[],currentPage:0,page_size:19,pageCount:0,total:0,name:"",dialogDocInfoVisible:!1,actClass:"actClass",dialogTransferDoc:!1,transferUsername:"",selectDocId:"",showSetting:!1,settingDocId:""}},computed:{paginationLayouts:function(){return this.total&&this.total/this.listQuery.page_size>1?"total, sizes, prev, pager, next, jumper":"total, sizes"}},created:function(){this.getAllProject()},methods:{dialogDocShow:function(){this.dialogDocInfoVisible=!0,this.name=""},getAllProject:function(){var e=this;this.loading=!0,Object(r["d"])(this.listQuery).then((function(t){200==t.code&&(e.docList=t.data.data,e.pageCount=t.data.page_count,e.total=t.data.total,e.loading=!1)})).catch((function(t){e.loading=!1}))},createDoc:function(){var e=this;Object(r["b"])({name:this.name,is_public:this.radio}).then((function(t){e.$message("创建成功！"),e.dialogDocInfoVisible=!1,e.getAllProject()}))},removeDoc:function(e){var t=this;this.$confirm("确定删除该文档吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.$post("/admin/document/delete",{id:e}).then((function(){t.getAllProject(),t.$message("删除成功！")}))}))},updateDoc:function(e,t){var a=this;this.$post("/admin/document/update",{id:e,is_show:1==t?2:1}).then((function(){a.docList.forEach((function(a){a.id!=e||(a.is_show=1==t?2:1)}))}))},readDoc:function(e){var t=this.$router.resolve({path:"/chapter/"+e.id});localStorage.projectName=e.name,window.open(t.href,"_blank")},settingDoc:function(e){this.settingDocId=e,this.showSetting=!0},transferDoc:function(e){this.selectDocId=e,this.transferUsername="",this.dialogTransferDoc=!0},transfer:function(){var e=this;this.$post("/admin/document/change-founder",{document_id:this.selectDocId,username:this.transferUsername}).then((function(){e.getAllProject(),e.$message("转让成功！"),e.dialogTransferDoc=!1}))},goChapter:function(e,t){var a={name:"chapter",params:{id:e.id}};t&&(a["query"]={type:"add",documentType:1}),localStorage.projectName=e.name,this.$router.push(a)},format:function(e){if(e){var t=Object(s["a"])(e);return t.length>8?Object(s["a"])(e).slice(5):Object(s["a"])(e)}},handleClose:function(){this.getAllProject(),this.showSetting=!1},handleSizeChange:function(e){this.listQuery.page_size=e,this.getAllProject()},handleCurrentChange:function(e){this.listQuery.page=e,this.getAllProject()}}},c=l,_=(a("7b79"),a("2877")),u=Object(_["a"])(c,i,o,!1,null,"99835010",null);t["default"]=u.exports},fa7d:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return timestampFormat}));var core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("a481"),core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(core_js_modules_es6_regexp_replace__WEBPACK_IMPORTED_MODULE_0__),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("6b54"),core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(core_js_modules_es6_regexp_to_string__WEBPACK_IMPORTED_MODULE_1__),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("4917"),core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_2___default=__webpack_require__.n(core_js_modules_es6_regexp_match__WEBPACK_IMPORTED_MODULE_2__),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("28a5"),core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(core_js_modules_es6_regexp_split__WEBPACK_IMPORTED_MODULE_3__),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("3b2b"),core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_4___default=__webpack_require__.n(core_js_modules_es6_regexp_constructor__WEBPACK_IMPORTED_MODULE_4__);function getUrlParam(e,t){var a=new RegExp("(^|&)"+t+"=([^&]*)(&|$)");if(e&&e.split("?")[1]){var i=e.split("?")[1].match(a);return null!=i?unescape(i[2]):null}}function replaceParamVal(url,paramName,replaceVal){var oUrl=url.toString(),re=eval("/("+paramName+"=)([^&]*)/gi"),nUrl=oUrl.replace(re,paramName+"="+replaceVal);return nUrl}function timestampFormat(e){var t=Date.parse(e)/1e3;function a(e){return(1==String(e).length?"0":"")+e}var i=parseInt((new Date).getTime()/1e3),o=i-t,s=new Date(1e3*i),r=new Date(1e3*t),n=r.getFullYear(),l=r.getMonth()+1,c=r.getDate(),_=r.getHours(),u=r.getMinutes();if(o<60)return"刚刚";if(o<3600)return Math.floor(o/60)+"分钟前";if(s.getFullYear()==n&&s.getMonth()+1==l&&s.getDate()==c)return"今天"+a(_)+":"+a(u);var d=new Date(1e3*(i-86400));return d.getFullYear()==n&&d.getMonth()+1==l&&d.getDate()==c?"昨天"+a(_)+":"+a(u):n+"年"+a(l)+"月"+a(c)+"日 "+a(_)+":"+a(u)}}}]);